---
title: "Untitled"
author: "Nathan Krieger"
date: "2026-02-18"
output: html_document
---

# K folds with varying degrees 

```{r}

set.seed(1)


library(ISLR2)
library(caret)
library(ggplot2)
#install.packages('caret')

k = 5 # Number of folds

max_degree <- 9
errors <- numeric(max_degree)

# Create folds
flds <- createFolds(Boston$medv, k, list = TRUE)
flds[[1]]

for (d in 1:max_degree) {
  
  folds <- numeric(k)
                   
  for(i in 1:k){
    # Get test indices for this fold
    test_index = flds[[i]]
    test = Boston[test_index, ]
    train = Boston[-test_index, ]
    
    m <- lm(medv ~ poly(lstat, d), data = train)
    
    predict <- predict(m, newdata = test)
    
    folds[i] = mean((test$medv - predict)^2)
    
  }
  
  errors[d] = mean(folds)
}

cv_results <- data.frame(Degree = 1:max_degree, CV_Error = errors)
print(cv_results)

ggplot(cv_results, aes(x = Degree, y = CV_Error)) +
  geom_line(color = "steelblue", size = 1) +
  geom_point(color = "darkred", size = 2) +
  scale_x_continuous(breaks = 1:9) +
  labs(title = "5-Fold CV Error vs. Polynomial Degree",
       x = "Polynomial Degree",
       y = "Mean Squared Error (CV)") +
  theme_minimal()


```


# LOOCV with varying degrees

```{r}



max_degree <- 5
errors <- numeric(max_degree)

for (d in 1:max_degree) {
  
  abc <- numeric(n)
                   
  for(i in 1:n){
    test = df[i, ]
    train = df[-i, ]
    
    m <- lm(y ~ poly(X1, d), data = train)
    
    predict <- predict(m, newdata = test)
    
    abc[i] = mean((test$y - predict)^2)
    
  }
  
  errors[d] = mean(abc)
}

cv_results <- data.frame(Degree = 1:max_degree, CV_Error = errors)
print(cv_results)

ggplot(cv_results, aes(x = Degree, y = CV_Error)) +
  geom_line(color = "steelblue", size = 1) +
  geom_point(color = "darkred", size = 2) +
  scale_x_continuous(breaks = 1:9) +
  labs(title = "LOOCV Error vs. Polynomial Degree",
       x = "Polynomial Degree",
       y = "Mean Squared Error (CV)") +
  theme_minimal()


```
  